<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Animated bar chart races in Python with matplotlib"><link href=https://www.dexplo.org/bar_chart_race/api/ rel=canonical><meta name=author content="Ted Petrou"><link rel="shortcut icon" href=../assets/images/favicon.png><meta name=generator content="mkdocs-1.1, mkdocs-material-5.2.1"><title>API Reference - Bar Chart Race</title><link rel=stylesheet href=../assets/stylesheets/main.71dfd922.min.css><link href=https://fonts.gstatic.com rel=preconnect crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback"><style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style><link rel="preconnect dns-prefetch" href=https://www.google-analytics.com><script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-119777567-7","dexplo.org"),ga("set","anonymizeIp",!0),ga("send","pageview"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){if(this.value){var e=document.location.pathname;ga("send","pageview",e+"?q="+this.value)}})}),document.addEventListener("DOMContentSwitch",function(){ga("send","pageview")})</script><script async src=https://www.google-analytics.com/analytics.js></script></head> <body dir=ltr> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> </div> <div data-md-component=announce> </div> <header class=md-header data-md-component=header> <nav class="md-header-nav md-grid" aria-label=Header> <a href=https://www.dexplo.org/bar_chart_race title="Bar Chart Race" class="md-header-nav__button md-logo" aria-label="Bar Chart Race"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg> </a> <label class="md-header-nav__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg> </label> <div class=md-header-nav__title data-md-component=header-title> <div class=md-header-nav__ellipsis> <span class="md-header-nav__topic md-ellipsis"> Bar Chart Race </span> <span class="md-header-nav__topic md-ellipsis"> API Reference </span> </div> </div> <label class="md-header-nav__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query data-md-state=active> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </label> <button type=reset class="md-search__icon md-icon" aria-label=Clear data-md-component=search-reset tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg> </button> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> <div class=md-header-nav__source> <a href=https://github.com/dexplo/bar_chart_race/ title="Go to repository" class=md-source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg> </div> <div class=md-source__repository> GitHub </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class="md-tabs__inner md-grid"> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=.. class="md-tabs__link md-tabs__link--active"> Home </a> </li> <li class=md-tabs__item> <a href=https://www.dexplo.org class=md-tabs__link> Dexplo Libraries </a> </li> </ul> </div> </nav> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=https://www.dexplo.org/bar_chart_race title="Bar Chart Race" class="md-nav__button md-logo" aria-label="Bar Chart Race"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg> </a> Bar Chart Race </label> <div class=md-nav__source> <a href=https://github.com/dexplo/bar_chart_race/ title="Go to repository" class=md-source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg> </div> <div class=md-source__repository> GitHub </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=.. title=Home class=md-nav__link> Home </a> </li> <li class=md-nav__item> <a href=../installation/ title=Installation class=md-nav__link> Installation </a> </li> <li class=md-nav__item> <a href=../whats_new/ title="What's New" class=md-nav__link> What's New </a> </li> <li class=md-nav__item> <a href=../tutorial/ title=Tutorial class=md-nav__link> Tutorial </a> </li> <li class=md-nav__item> <a href=../data_preparation/ title="Data Preparation" class=md-nav__link> Data Preparation </a> </li> <li class=md-nav__item> <a href=../upcoming/ title="Upcoming Features" class=md-nav__link> Upcoming Features </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" data-md-toggle=toc type=checkbox id=__toc> <a href=./ title="API Reference" class="md-nav__link md-nav__link--active"> API Reference </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-8 type=checkbox id=nav-8> <label class=md-nav__link for=nav-8> Dexplo Libraries <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg> </span> </label> <nav class=md-nav aria-label="Dexplo Libraries" data-md-level=1> <label class=md-nav__title for=nav-8> <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </span> Dexplo Libraries </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=https://www.dexplo.org title=Dexplo class=md-nav__link> Dexplo </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content> <article class="md-content__inner md-typeset"> <a href=https://github.com/dexplo/bar_chart_race/edit/master/docs/api.md title="Edit this page" class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg> </a> <!doctype html><html> <head><meta charset=utf-8><meta name=viewport content="width=device-width, initial-scale=1, minimum-scale=1"><meta name=generator content="pdoc 0.8.1"><title>bar_chart_race API documentation</title><meta name=description content><link href=https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.0/normalize.min.css rel=stylesheet><link href=https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/8.0.0/sanitize.min.css rel=stylesheet><link href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css rel=stylesheet><style>.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:30px;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}a{color:#058;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#e82}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900}pre code{background:#f8f8f8;font-size:.8em;line-height:1.4em}code{background:#f2f2f1;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#f8f8f8;border:0;border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0;padding:1ex}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-weight:bold;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}.admonition{padding:.1em .5em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style><style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.item .name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style><style media=print>@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style></head> <body> <main> <article id=content> <header> <h1 class=title>Package <code>bar_chart_race</code></h1> </header> <section id=section-intro> <details class=source> <summary> <span>Expand source code</span> </summary> <pre><code class=python>from ._make_chart import bar_chart_race, load_dataset, prepare_wide_data, prepare_long_data
__version__ = &#34;0.0.7&#34;

<p><strong>all</strong> = [&#39;bar_chart_race&#39;, &#39;load_dataset&#39;, &#39;prepare_wide_data&#39;, &#39;prepare_long_data&#39;]</code></pre> </details> </section> <section> </section> <section> </section> <section> <h2 class=section-title id=header-functions>Functions</h2> <dl> <dt id=bar_chart_race.bar_chart_race><code class="name flex"> <span>def <span class=ident>bar_chart_race</span></span>(<span>df, filename=None, orientation='h', sort='desc', n_bars=None, fixed_order=False, fixed_max=False, steps_per_period=10, period_length=500, interpolate_period=False, label_bars=True, bar_size=0.95, period_label=True, period_fmt=None, period_summary_func=None, perpendicular_bar_func=None, figsize=(6, 3.5), cmap='dark24', title=None, title_size=None, bar_label_size=7, tick_label_size=7, shared_fontdict=None, scale='linear', writer=None, fig=None, dpi=144, bar_kwargs=None, filter_column_colors=False)</span> </code></dt> <dd> <div class=desc><p>Create an animated bar chart race using matplotlib. Data must be in 'wide' format where each row represents a single time period and each column represents a distinct category. Optionally, the index can label the time period.</p> <p>Bar height and location change linearly from one time period to the next.</p> <p>If no <code>filename</code> is given, an HTML string is returned, otherwise the animation is saved to disk.</p> <p>You must have ffmpeg installed on your machine to save files to disk. Get ffmpeg here: <a href=https://www.ffmpeg.org/download.html>https://www.ffmpeg.org/download.html</a></p> <p>To save .gif files you'll need to install ImageMagick.</p> <p>This is resource intensive - Start with just a few rows of data to test.</p> <h2 id=parameters>Parameters</h2> <dl> <dt><strong><code>df</code></strong> :&ensp;<code>pandas DataFrame</code></dt> <dd>Must be a 'wide' DataFrame where each row represents a single period of time. Each column contains the values of the bars for that category. Optionally, use the index to label each time period. The index can be of any type.</dd> <dt><strong><code>filename</code></strong> :&ensp;<code>None</code> or <code>str</code>, default <code>None</code></dt> <dd>If <code>None</code> return animation as an HTML5 string. If a string, save animation to that filename location. Use .mp4, .gif, .html, .mpeg, .mov and any other extensions supported by ffmpeg or ImageMagick.</dd> <dt><strong><code>orientation</code></strong> :&ensp;<code>'h'</code> or <code>'v'</code>, default <code>'h'</code></dt> <dd>Bar orientation - horizontal or vertical</dd> <dt><strong><code>sort</code></strong> :&ensp;<code>'desc'</code> or <code>'asc'</code>, default <code>'desc'</code></dt> <dd>Choose how to sort the bars. Use 'desc' to put largest bars on top and 'asc' to place largest bars on bottom.</dd> <dt><strong><code>n_bars</code></strong> :&ensp;<code>int</code>, default <code>None</code></dt> <dd>Choose the maximum number of bars to display on the graph. By default, use all bars. New bars entering the race will appear from the edge of the axes.</dd> <dt><strong><code>fixed_order</code></strong> :&ensp;<code>bool</code> or <code>list</code>, default <code>False</code></dt> <dd>When <code>False</code>, bar order changes every time period to correspond with <code>sort</code>. When <code>True</code>, bars remained fixed according to their final value corresponding with <code>sort</code>. Otherwise, provide a list of the exact order of the categories for the entire duration.</dd> <dt><strong><code>fixed_max</code></strong> :&ensp;<code>bool</code>, default <code>False</code></dt> <dd> <p>Whether to fix the maximum value of the axis containing the values. When <code>False</code>, the axis for the values will have its maximum (xlim/ylim) just after the largest bar of the current time period. The axis maximum will change along with the data.</p> <p>When True, the maximum axis value will remain constant for the duration of the animation. For example, in a horizontal bar chart, if the largest bar has a value of 100 for the first time period and 10,000 for the last time period. The xlim maximum will be 10,000 for each frame.</p> </dd> <dt><strong><code>steps_per_period</code></strong> :&ensp;<code>int</code>, default <code>10</code></dt> <dd>The number of steps to go from one time period to the next. The bars will grow linearly between each period.</dd> <dt><strong><code>period_length</code></strong> :&ensp;<code>int</code>, default <code>500</code></dt> <dd>Number of milliseconds to animate each period (row). Default is 500ms (half of a second)</dd> <dt><strong><code>interpolate_period</code></strong> :&ensp;<code>bool</code>, default <code>False</code></dt> <dd>Whether to interpolate the period. Only valid for datetime or numeric indexes. When set to <code>True</code>, for example, the two consecutive periods 2020-03-29 and 2020-03-30 with <code>steps_per_period</code> set to 4 would yield a new index of 2020-03-29 00:00:00 2020-03-29 06:00:00 2020-03-29 12:00:00 2020-03-29 18:00:00 2020-03-30 00:00:00</dd> <dt><strong><code>label_bars</code></strong> :&ensp;<code>bool</code>, default <code>True</code></dt> <dd>Whether to label the bars with their value on their right</dd> <dt><strong><code>bar_size</code></strong> :&ensp;<code>float</code>, default <code>.95</code></dt> <dd>Height/width of bars for horizontal/vertical bar charts. Use a number between 0 and 1 Represents the fraction of space that each bar takes up. When equal to 1, no gap remains between the bars.</dd> <dt><strong><code>period_label</code></strong> :&ensp;<code>bool</code> or <code>dict</code>, default <code>True</code></dt> <dd> <p>If <code>True</code> or dict, use the index as a large text label on the axes whose value changes</p> <p>Use a dictionary to supply the exact position of the period along with any valid parameters of the matplotlib <code>text</code> method. At a minimum, you must supply both 'x' and 'y' in axes coordinates</p> <p>Example: { 'x': .99, 'y': .8, 'ha': 'right', 'va': 'center' }</p> <p>If <code>False</code> - don't place label on axes</p> </dd> <dt><strong><code>period_fmt</code></strong> :&ensp;<code>str</code>, default <code>None</code></dt> <dd> <p>Either a string with date directives or a new-style (Python 3.6+) formatted string</p> <p>For a string with a date directive, find the complete list here <a href=https://docs.python.org/3/library/datetime.html#strftime-and-strptime-format-codes>https://docs.python.org/3/library/datetime.html#strftime-and-strptime-format-codes</a></p> <p>Example of string with date directives '%B %d, %Y' Will change 2020/03/29 to March 29, 2020</p> <p>For new-style formatted string. Use curly braces and the variable <code>x</code>, which will be passed the current period's index value. Example: 'Period {x:10.2f}'</p> <p>Date directives will only be used for datetime indexes.</p> </dd> <dt><strong><code>period_summary_func</code></strong> :&ensp;<code>function</code>, default <code>None</code></dt> <dd> <p>Custom text added to the axes each period. Create a user-defined function that accepts two pandas Series of the current time period's values and ranks. It must return a dictionary containing at a minimum the keys "x", "y", and "s" which will be passed to the matplotlib <code>text</code> method.</p> <p>Example: def func(values, ranks): total = values.sum() s = f'Worldwide deaths: {total}' return {'x': .85, 'y': .2, 's': s, 'ha': 'right', 'size': 11}</p> </dd> <dt><strong><code>perpendicular_bar_func</code></strong> :&ensp;<code>function</code> or <code>str</code>, default <code>None</code></dt> <dd> <p>Creates a single bar perpendicular to the main bars that spans the length of the axis. </p> <p>Use either a string that the DataFrame <code>agg</code> method understands or a user-defined function.</p> <p>DataFrame strings - 'mean', 'median', 'max', 'min', etc..</p> <p>The function is passed two pandas Series of the current time period's data and ranks. It must return a single value.</p> <p>def func(values, ranks): return values.quantile(.75)</p> </dd> <dt><strong><code>figsize</code></strong> :&ensp;<code>two-item tuple</code> of <code>numbers</code>, default <code>(6, 3.5)</code></dt> <dd>matplotlib figure size in inches. Will be overridden if figure supplied to <code>fig</code>.</dd> <dt><strong><code>cmap</code></strong> :&ensp;<code>str, matplotlib colormap instance,</code> or <code>list</code> of <code>colors</code>, default <code>'dark24'</code></dt> <dd>Colors to be used for the bars. All matplotlib and plotly colormaps are available by string name. Colors will repeat if there are more bars than colors.</dd> <dt><strong><code>title</code></strong> :&ensp;<code>str</code>, default <code>None</code></dt> <dd>Title of plot</dd> <dt><strong><code>title_size</code></strong> :&ensp;<code>number</code> or <code>str</code>, default <code>plt.rcParams['axes.titlesize']</code></dt> <dd>Size in points of title or relative size str. See Font Help below.</dd> <dt><strong><code>bar_label_size</code></strong> :&ensp;<code>number</code> or <code>str</code>, default <code>7</code></dt> <dd>Size in points or relative size str of numeric labels just outside of the bars. See Font Help below.</dd> <dt><strong><code>tick_label_size</code></strong> :&ensp;<code>number</code> or <code>str</code>, default <code>7</code></dt> <dd>Size in points of tick labels. See Font Help below. See Font Help below</dd> <dt><strong><code>shared_fontdict</code></strong> :&ensp;<code>dict</code>, default <code>None</code></dt> <dd> <p>Dictionary of font properties shared across the tick labels, bar labels, period labels, and title. The only property not shared is <code>size</code>. It will be ignored if you try to set it.</p> <p>Possible keys are: 'family', 'weight', 'color', 'style', 'stretch', 'weight', 'variant' Here is an example dictionary: { 'family' : 'Helvetica', 'weight' : 'bold', 'color' : 'rebeccapurple' }</p> </dd> <dt><strong><code>scale</code></strong> :&ensp;<code>'linear'</code> or <code>'log'</code>, default <code>'linear'</code></dt> <dd>Type of scaling to use for the axis containing the values</dd> <dt><strong><code>writer</code></strong> :&ensp;<code>str</code> or <code>matplotlib Writer instance</code></dt> <dd> <p>This argument is passed to the matplotlib FuncAnimation.save method.</p> <p>By default, the writer will be 'ffmpeg' unless creating a gif, then it will be 'imagemagick', or an html file, then it will be 'html'. </p> <p>Find all of the availabe Writers:</p> <blockquote> <blockquote> <blockquote> <p>from matplotlib import animation animation.writers.list()</p> </blockquote> </blockquote> </blockquote> <p>You must have ffmpeg or ImageMagick installed in order</p> </dd> <dt><strong><code>fig</code></strong> :&ensp;<code>matplotlib Figure</code>, default <code>None</code></dt> <dd>For greater control over the aesthetics, supply your own figure.</dd> <dt><strong><code>dpi</code></strong> :&ensp;<code>int</code>, default <code>144</code></dt> <dd>Dots per Inch of the matplotlib figure</dd> <dt><strong><code>bar_kwargs</code></strong> :&ensp;<code>dict</code>, default <code><code>None&lt;/code&gt; (alpha=.8)</code></dt> <dd>Other keyword arguments (within a dictionary) forwarded to the matplotlib <code>barh</code>/<code>bar</code> function. If no value for 'alpha' is given, then it is set to .8 by default. Some examples: <code>ec</code> - edgecolor - color of edge of bar. Default is 'white' <code>lw</code> - width of edge in points. Default is 1.5 <code>alpha</code> - opacity of bars, 0 to 1</dd> <dt><strong><code>filter_column_colors</code></strong> :&ensp;<code>bool</code>, default <code>False</code></dt> <dd> <p>When setting n_bars, it's possible that some columns never appear in the animation. Regardless, all columns get assigned a color by default. </p> <p>For instance, suppose you have 100 columns in your DataFrame, set n_bars to 10, and 15 different columns make at least one appearance in the animation. Even if your colormap has at least 15 colors, it's possible that many bars will be the same color, since each of the 100 columns is assigned of the colormaps colors.</p> <p>Setting this to <code>True</code> will map your colormap to just those columns that make an appearance in the animation, helping avoid duplication of colors.</p> <p>Setting this to <code>True</code> will also have the (possibly unintended) consequence of changing the colors of each color every time a new integer for n_bars is used.</p> <p>EXPERIMENTAL This parameter is experimental and may be changed/removed in a later version.</p> </dd> </dl> <h2 id=returns>Returns</h2> <p>When <code>filename</code> is left as <code>None</code>, an HTML5 video is returned as a string. Otherwise, a file of the animation is saved and <code>None</code> is returned.</p> <h2 id=notes>Notes</h2> <p>It is possible for some bars to be out of order momentarily during a transition since both height and location change linearly and not directly with respect to their current value. This keeps all the transitions identical.</p> <h2 id=examples>Examples</h2> <p>Use the <code>load_data</code> function to get an example dataset to create an animation.</p> <p>df = bcr.load_dataset('covid19') bcr.bar_chart_race( df=df, filename='covid19_horiz_desc.mp4', orientation='h', sort='desc', n_bars=8, fixed_order=False, fixed_max=True, steps_per_period=10, period_length=500, interpolate_period=False, label_bars=True, bar_size=.95, period_label={'x': .99, 'y': .8, 'ha': 'right', 'va': 'center'}, period_fmt='%B %d, %Y', period_summary_func=lambda v, r: {'x': .85, 'y': .2, 's': f'Total deaths: {v.sum()}', 'ha': 'right', 'size': 11}, perpendicular_bar_func='median', figsize=(5, 3), dpi=144, cmap='dark24', title='COVID-19 Deaths by Country', title_size='', bar_label_size=7, tick_label_size=7, shared_fontdict={'family' : 'Helvetica', 'weight' : 'bold', 'color' : '.1'}, scale='linear', writer=None, fig=None, bar_kwargs={'alpha': .7}, filter_column_colors=False) </p> <h2 id=font-help>Font Help</h2> <p>Font size can also be a string - 'xx-small', 'x-small', 'small',<br> 'medium', 'large', 'x-large', 'xx-large', 'smaller', 'larger' These sizes are relative to plt.rcParams['font.size'].</p></div> <details class=source> <summary> <span>Expand source code</span> </summary> <pre><code class=python>def bar_chart_race(df, filename=None, orientation=&#39;h&#39;, sort=&#39;desc&#39;, n_bars=None, 
                   fixed_order=False, fixed_max=False, steps_per_period=10, 
                   period_length=500, interpolate_period=False, label_bars=True, 
                   bar_size=.95, period_label=True, period_fmt=None, 
                   period_summary_func=None, perpendicular_bar_func=None, figsize=(6, 3.5),
                   cmap=&#39;dark24&#39;, title=None, title_size=None, bar_label_size=7, 
                   tick_label_size=7, shared_fontdict=None, scale=&#39;linear&#39;, writer=None, 
                   fig=None, dpi=144, bar_kwargs=None, filter_column_colors=False):
    &#39;&#39;&#39;
    Create an animated bar chart race using matplotlib. Data must be in 
    &#39;wide&#39; format where each row represents a single time period and each 
    column represents a distinct category. Optionally, the index can label 
    the time period.</p>
<div class=codehilite><pre><span></span><code>Bar height and location change linearly from one time period to the next.

If no `filename` is given, an HTML string is returned, otherwise the 
animation is saved to disk.

You must have ffmpeg installed on your machine to save files to disk.
Get ffmpeg here: https://www.ffmpeg.org/download.html

To save .gif files you&amp;#39;ll need to install ImageMagick.

This is resource intensive - Start with just a few rows of data to test.


Parameters
----------
df : pandas DataFrame
    Must be a &amp;#39;wide&amp;#39; DataFrame where each row represents a single period 
    of time. Each column contains the values of the bars for that 
    category. Optionally, use the index to label each time period.
    The index can be of any type.

filename : `None` or str, default None
    If `None` return animation as an HTML5 string.
    If a string, save animation to that filename location. 
    Use .mp4, .gif, .html, .mpeg, .mov and any other extensions supported
    by ffmpeg or ImageMagick.

orientation : &amp;#39;h&amp;#39; or &amp;#39;v&amp;#39;, default &amp;#39;h&amp;#39;
    Bar orientation - horizontal or vertical

sort : &amp;#39;desc&amp;#39; or &amp;#39;asc&amp;#39;, default &amp;#39;desc&amp;#39;
    Choose how to sort the bars. Use &amp;#39;desc&amp;#39; to put largest bars on top 
    and &amp;#39;asc&amp;#39; to place largest bars on bottom.

n_bars : int, default None
    Choose the maximum number of bars to display on the graph. 
    By default, use all bars. New bars entering the race will appear 
    from the edge of the axes.

fixed_order : bool or list, default False
    When `False`, bar order changes every time period to correspond 
    with `sort`. When `True`, bars remained fixed according to their 
    final value corresponding with `sort`. Otherwise, provide a list 
    of the exact order of the categories for the entire duration.

fixed_max : bool, default False
    Whether to fix the maximum value of the axis containing the values.
    When `False`, the axis for the values will have its maximum (xlim/ylim)
    just after the largest bar of the current time period. 
    The axis maximum will change along with the data.

    When True, the maximum axis value will remain constant for the 
    duration of the animation. For example, in a horizontal bar chart, 
    if the largest bar has a value of 100 for the first time period and 
    10,000 for the last time period. The xlim maximum will be 10,000 
    for each frame.

steps_per_period : int, default 10
    The number of steps to go from one time period to the next. 
    The bars will grow linearly between each period.

period_length : int, default 500
    Number of milliseconds to animate each period (row). 
    Default is 500ms (half of a second)

interpolate_period : bool, default `False`
    Whether to interpolate the period. Only valid for datetime or
    numeric indexes. When set to `True`, for example, 
    the two consecutive periods 2020-03-29 and 2020-03-30 with 
    `steps_per_period` set to 4 would yield a new index of
    2020-03-29 00:00:00
    2020-03-29 06:00:00
    2020-03-29 12:00:00
    2020-03-29 18:00:00
    2020-03-30 00:00:00

label_bars : bool, default `True`
    Whether to label the bars with their value on their right

bar_size : float, default .95
    Height/width of bars for horizontal/vertical bar charts. 
    Use a number between 0 and 1
    Represents the fraction of space that each bar takes up. 
    When equal to 1, no gap remains between the bars.

period_label : bool or dict, default `True`
    If `True` or dict, use the index as a large text label
    on the axes whose value changes

    Use a dictionary to supply the exact position of the period
    along with any valid parameters of the matplotlib `text` method.
    At a minimum, you must supply both &amp;#39;x&amp;#39; and &amp;#39;y&amp;#39; in axes coordinates

    Example:
    {
        &amp;#39;x&amp;#39;: .99,
        &amp;#39;y&amp;#39;: .8,
        &amp;#39;ha&amp;#39;: &amp;#39;right&amp;#39;,
        &amp;#39;va&amp;#39;: &amp;#39;center&amp;#39;
    }

    If `False` - don&amp;#39;t place label on axes

period_fmt : str, default `None`
    Either a string with date directives or 
    a new-style (Python 3.6+) formatted string

    For a string with a date directive, find the complete list here
    https://docs.python.org/3/library/datetime.html#strftime-and-strptime-format-codes

    Example of string with date directives
        &amp;#39;%B %d, %Y&amp;#39;
    Will change 2020/03/29 to March 29, 2020

    For new-style formatted string. Use curly braces and the variable `x`, 
    which will be passed the current period&amp;#39;s index value.
    Example:
        &amp;#39;Period {x:10.2f}&amp;#39;

    Date directives will only be used for datetime indexes.

period_summary_func : function, default None
    Custom text added to the axes each period.
    Create a user-defined function that accepts two pandas Series of the 
    current time period&amp;#39;s values and ranks. It must return a dictionary 
    containing at a minimum the keys &amp;#34;x&amp;#34;, &amp;#34;y&amp;#34;, and &amp;#34;s&amp;#34; which will be 
    passed to the matplotlib `text` method.

    Example:
    def func(values, ranks):
        total = values.sum()
        s = f&amp;#39;Worldwide deaths: {total}&amp;#39;
        return {&amp;#39;x&amp;#39;: .85, &amp;#39;y&amp;#39;: .2, &amp;#39;s&amp;#39;: s, &amp;#39;ha&amp;#39;: &amp;#39;right&amp;#39;, &amp;#39;size&amp;#39;: 11}

perpendicular_bar_func : function or str, default None
    Creates a single bar perpendicular to the main bars that spans the 
    length of the axis.

    Use either a string that the DataFrame `agg` method understands or a 
    user-defined function.

    DataFrame strings - &amp;#39;mean&amp;#39;, &amp;#39;median&amp;#39;, &amp;#39;max&amp;#39;, &amp;#39;min&amp;#39;, etc..

    The function is passed two pandas Series of the current time period&amp;#39;s
    data and ranks. It must return a single value.

    def func(values, ranks):
        return values.quantile(.75)

figsize : two-item tuple of numbers, default (6, 3.5)
    matplotlib figure size in inches. Will be overridden if figure 
    supplied to `fig`.

cmap : str, matplotlib colormap instance, or list of colors, default &amp;#39;dark24&amp;#39;
    Colors to be used for the bars. All matplotlib and plotly colormaps are 
    available by string name. Colors will repeat if there are more bars than colors.

title : str, default None
    Title of plot

title_size : number or str, default plt.rcParams[&amp;#39;axes.titlesize&amp;#39;]
    Size in points of title or relative size str. See Font Help below.

bar_label_size : number or str, default 7
    Size in points or relative size str of numeric labels 
    just outside of the bars. See Font Help below.

tick_label_size : number or str, default 7
    Size in points of tick labels. See Font Help below. 
    See Font Help below

shared_fontdict : dict, default None
    Dictionary of font properties shared across the tick labels, 
    bar labels, period labels, and title. The only property not shared 
    is `size`. It will be ignored if you try to set it.

    Possible keys are:
        &amp;#39;family&amp;#39;, &amp;#39;weight&amp;#39;, &amp;#39;color&amp;#39;, &amp;#39;style&amp;#39;, &amp;#39;stretch&amp;#39;, &amp;#39;weight&amp;#39;, &amp;#39;variant&amp;#39;
    Here is an example dictionary:
    {
        &amp;#39;family&amp;#39; : &amp;#39;Helvetica&amp;#39;,
        &amp;#39;weight&amp;#39; : &amp;#39;bold&amp;#39;,
        &amp;#39;color&amp;#39; : &amp;#39;rebeccapurple&amp;#39;
    }

scale : &amp;#39;linear&amp;#39; or &amp;#39;log&amp;#39;, default &amp;#39;linear&amp;#39;
    Type of scaling to use for the axis containing the values

writer : str or matplotlib Writer instance
    This argument is passed to the matplotlib FuncAnimation.save method.

    By default, the writer will be &amp;#39;ffmpeg&amp;#39; unless creating a gif,
    then it will be &amp;#39;imagemagick&amp;#39;, or an html file, then it 
    will be &amp;#39;html&amp;#39;.

    Find all of the availabe Writers:
    &gt;&gt;&gt; from matplotlib import animation
    &gt;&gt;&gt; animation.writers.list()

    You must have ffmpeg or ImageMagick installed in order

fig : matplotlib Figure, default None
    For greater control over the aesthetics, supply your own figure.

dpi : int, default 144
    Dots per Inch of the matplotlib figure

bar_kwargs : dict, default `None` (alpha=.8)
    Other keyword arguments (within a dictionary) forwarded to the 
    matplotlib `barh`/`bar` function. If no value for &amp;#39;alpha&amp;#39; is given,
    then it is set to .8 by default.
    Some examples:
        `ec` - edgecolor - color of edge of bar. Default is &amp;#39;white&amp;#39;
        `lw` - width of edge in points. Default is 1.5
        `alpha` - opacity of bars, 0 to 1

filter_column_colors : bool, default `False`
    When setting n_bars, it&amp;#39;s possible that some columns never 
    appear in the animation. Regardless, all columns get assigned
    a color by default.

    For instance, suppose you have 100 columns 
    in your DataFrame, set n_bars to 10, and 15 different columns 
    make at least one appearance in the animation. Even if your 
    colormap has at least 15 colors, it&amp;#39;s possible that many 
    bars will be the same color, since each of the 100 columns is
    assigned of the colormaps colors.

    Setting this to `True` will map your colormap to just those 
    columns that make an appearance in the animation, helping
    avoid duplication of colors.

    Setting this to `True` will also have the (possibly unintended)
    consequence of changing the colors of each color every time a 
    new integer for n_bars is used.

    EXPERIMENTAL
    This parameter is experimental and may be changed/removed
    in a later version.


Returns
-------
When `filename` is left as `None`, an HTML5 video is returned as a string.
Otherwise, a file of the animation is saved and `None` is returned.

Notes
-----
It is possible for some bars to be out of order momentarily during a 
transition since both height and location change linearly and not 
directly with respect to their current value. This keeps all the 
transitions identical.

Examples
--------
Use the `load_data` function to get an example dataset to 
create an animation.

df = bcr.load_dataset(&amp;#39;covid19&amp;#39;)
bcr.bar_chart_race(
    df=df, 
    filename=&amp;#39;covid19_horiz_desc.mp4&amp;#39;, 
    orientation=&amp;#39;h&amp;#39;, 
    sort=&amp;#39;desc&amp;#39;, 
    n_bars=8, 
    fixed_order=False, 
    fixed_max=True, 
    steps_per_period=10, 
    period_length=500, 
    interpolate_period=False, 
    label_bars=True, 
    bar_size=.95, 
    period_label={&amp;#39;x&amp;#39;: .99, &amp;#39;y&amp;#39;: .8, &amp;#39;ha&amp;#39;: &amp;#39;right&amp;#39;, &amp;#39;va&amp;#39;: &amp;#39;center&amp;#39;}, 
    period_fmt=&amp;#39;%B %d, %Y&amp;#39;, 
    period_summary_func=lambda v, r: {&amp;#39;x&amp;#39;: .85, &amp;#39;y&amp;#39;: .2, 
                                      &amp;#39;s&amp;#39;: f&amp;#39;Total deaths: {v.sum()}&amp;#39;, 
                                      &amp;#39;ha&amp;#39;: &amp;#39;right&amp;#39;, &amp;#39;size&amp;#39;: 11}, 
    perpendicular_bar_func=&amp;#39;median&amp;#39;, 
    figsize=(5, 3), 
    dpi=144,
    cmap=&amp;#39;dark24&amp;#39;, 
    title=&amp;#39;COVID-19 Deaths by Country&amp;#39;, 
    title_size=&amp;#39;&amp;#39;, 
    bar_label_size=7, 
    tick_label_size=7, 
    shared_fontdict={&amp;#39;family&amp;#39; : &amp;#39;Helvetica&amp;#39;, &amp;#39;weight&amp;#39; : &amp;#39;bold&amp;#39;, &amp;#39;color&amp;#39; : &amp;#39;.1&amp;#39;}, 
    scale=&amp;#39;linear&amp;#39;, 
    writer=None, 
    fig=None, 
    bar_kwargs={&amp;#39;alpha&amp;#39;: .7},
    filter_column_colors=False)

Font Help
---------
Font size can also be a string - &amp;#39;xx-small&amp;#39;, &amp;#39;x-small&amp;#39;, &amp;#39;small&amp;#39;,  
    &amp;#39;medium&amp;#39;, &amp;#39;large&amp;#39;, &amp;#39;x-large&amp;#39;, &amp;#39;xx-large&amp;#39;, &amp;#39;smaller&amp;#39;, &amp;#39;larger&amp;#39;
These sizes are relative to plt.rcParams[&amp;#39;font.size&amp;#39;].
&amp;#39;&amp;#39;&amp;#39;
bcr = _BarChartRace(df, filename, orientation, sort, n_bars, fixed_order, fixed_max,
                    steps_per_period, period_length, interpolate_period, label_bars, bar_size, 
                    period_label, period_fmt, period_summary_func, perpendicular_bar_func, 
                    figsize, cmap, title, title_size, bar_label_size, tick_label_size, 
                    shared_fontdict, scale, writer, fig, dpi, bar_kwargs, filter_column_colors)
return bcr.make_animation()&lt;/code&gt;&lt;/pre&gt;
</code></pre></div>


<p></details> </dd> <dt id=bar_chart_race.load_dataset><code class="name flex"> <span>def <span class=ident>load_dataset</span></span>(<span>name='covid19')</span> </code></dt> <dd> <div class=desc><p>Return a pandas DataFrame suitable for immediate use in <code><a title=bar_chart_race.bar_chart_race href=#bar_chart_race.bar_chart_race>bar_chart_race()</a></code>. Must be connected to the internet</p> <h2 id=parameters>Parameters</h2> <dl> <dt><strong><code>name</code></strong> :&ensp;<code>str</code>, default <code>'covid19'</code></dt> <dd>Name of dataset to load. Either 'covid19' or 'urban_pop'</dd> </dl> <h2 id=returns>Returns</h2> <dl> <dt><code>pandas DataFrame</code></dt> <dd>&nbsp;</dd> </dl></div> <details class=source> <summary> <span>Expand source code</span> </summary> <pre><code class=python>def load_dataset(name=&#39;covid19&#39;):
    &#39;&#39;&#39;
    Return a pandas DataFrame suitable for immediate use in <code>bar_chart_race</code>.
    Must be connected to the internet</p>
<div class=codehilite><pre><span></span><code>Parameters
----------
name : str, default &amp;#39;covid19&amp;#39;
    Name of dataset to load. Either &amp;#39;covid19&amp;#39; or &amp;#39;urban_pop&amp;#39;

Returns
-------
pandas DataFrame
&amp;#39;&amp;#39;&amp;#39;
url = f&amp;#39;https://raw.githubusercontent.com/dexplo/bar_chart_race/master/data/{name}.csv&amp;#39;

index_dict = {&amp;#39;covid19_tutorial&amp;#39;: &amp;#39;date&amp;#39;,
            &amp;#39;covid19&amp;#39;: &amp;#39;date&amp;#39;,
             &amp;#39;urban_pop&amp;#39;: &amp;#39;year&amp;#39;}
index_col = index_dict[name]
return pd.read_csv(url, index_col=index_col, parse_dates=[index_col])&lt;/code&gt;&lt;/pre&gt;
</code></pre></div>


<p></details> </dd> <dt id=bar_chart_race.prepare_long_data><code class="name flex"> <span>def <span class=ident>prepare_long_data</span></span>(<span>df, index, columns, values, aggfunc='sum', orientation='h', sort='desc', n_bars=None, interpolate_period=False, steps_per_period=10, compute_ranks=True)</span> </code></dt> <dd> <div class=desc><p>Prepares 'long' data for bar chart animation. Returns two DataFrames - the interpolated values and the interpolated ranks</p> <p>You (currently) cannot pass long data to <code><a title=bar_chart_race.bar_chart_race href=#bar_chart_race.bar_chart_race>bar_chart_race()</a></code> directly. Use this function to create your wide data first before passing it to <code><a title=bar_chart_race.bar_chart_race href=#bar_chart_race.bar_chart_race>bar_chart_race()</a></code>.</p> <h2 id=parameters>Parameters</h2> <dl> <dt><strong><code>df</code></strong> :&ensp;<code>pandas DataFrame</code></dt> <dd> <p>Must be a 'long' pandas DataFrame where one column contains the period, another the categories, and the third the values of each category for each period. </p> <p>This DataFrame will be passed to the <code>pivot_table</code> method to turn it into a wide DataFrame. It will then be passed to the <code><a title=bar_chart_race.prepare_wide_data href=#bar_chart_race.prepare_wide_data>prepare_wide_data()</a></code> function.</p> </dd> <dt><strong><code>index</code></strong> :&ensp;<code>str</code></dt> <dd>Name of column used for the time period. It will be placed in the index</dd> <dt><strong><code>columns</code></strong> :&ensp;<code>str</code></dt> <dd>Name of column containing the categories for each time period. This column will get pivoted so that each unique value is a column.</dd> <dt><strong><code>values</code></strong> :&ensp;<code>str</code></dt> <dd>Name of column holding the values for each time period of each category. This column will become the values of the resulting DataFrame</dd> <dt><strong><code>aggfunc</code></strong> :&ensp;<code>str</code> or <code>aggregation function</code>, default <code>'sum'</code></dt> <dd>String name of aggregation function ('sum', 'min', 'mean', 'max, etc&hellip;) or actual function (np.sum, np.min, etc&hellip;). Categories that have multiple values for the same time period must be aggregated for the animation to work.</dd> <dt><strong><code>orientation</code></strong> :&ensp;<code>'h'</code> or <code>'v'</code>, default <code>'h'</code></dt> <dd>Bar orientation - horizontal or vertical</dd> <dt><strong><code>sort</code></strong> :&ensp;<code>'desc'</code> or <code>'asc'</code>, default <code>'desc'</code></dt> <dd>Choose how to sort the bars. Use 'desc' to put largest bars on top and 'asc' to place largest bars on bottom.</dd> <dt><strong><code>n_bars</code></strong> :&ensp;<code>int</code>, default <code>None</code></dt> <dd>Choose the maximum number of bars to display on the graph. By default, use all bars. New bars entering the race will appear from the bottom or top.</dd> <dt><strong><code>interpolate_period</code></strong> :&ensp;<code>bool</code>, default <code>False</code></dt> <dd>Whether to interpolate the period. Only valid for datetime or numeric indexes. When set to <code>True</code>, for example, the two consecutive periods 2020-03-29 and 2020-03-30 with <code>steps_per_period</code> set to 4 would yield a new index of 2020-03-29 00:00:00 2020-03-29 06:00:00 2020-03-29 12:00:00 2020-03-29 18:00:00 2020-03-30 00:00:00</dd> <dt><strong><code>steps_per_period</code></strong> :&ensp;<code>int</code>, default <code>10</code></dt> <dd>The number of steps to go from one time period to the next. The bars will grow linearly between each period.</dd> <dt><strong><code>compute_ranks</code></strong> :&ensp;<code>bool</code>, default <code>True</code></dt> <dd>When <code>True</code> return both the interpolated values and ranks DataFrames Otherwise just return the values</dd> </dl> <h2 id=returns>Returns</h2> <dl> <dt><code>A tuple</code> of <code>DataFrames. The first is the interpolated values and the second</code></dt> <dd>&nbsp;</dd> </dl> <p>is the interpolated ranks.</p> <h2 id=examples>Examples</h2> <p>df_values, df_ranks = bcr.prepare_long_data(df) bcr.bar_chart_race(df_values, steps_per_period=1, period_length=50)</p></div> <details class=source> <summary> <span>Expand source code</span> </summary> <pre><code class=python>def prepare_long_data(df, index, columns, values, aggfunc=&#39;sum&#39;, orientation=&#39;h&#39;, 
                      sort=&#39;desc&#39;, n_bars=None, interpolate_period=False, 
                      steps_per_period=10, compute_ranks=True):
    &#39;&#39;&#39;
    Prepares &#39;long&#39; data for bar chart animation. 
    Returns two DataFrames - the interpolated values and the interpolated ranks</p>
<div class=codehilite><pre><span></span><code>You (currently) cannot pass long data to `bar_chart_race` directly. Use this function
to create your wide data first before passing it to `bar_chart_race`.

Parameters
----------
df : pandas DataFrame
    Must be a &amp;#39;long&amp;#39; pandas DataFrame where one column contains 
    the period, another the categories, and the third the values 
    of each category for each period.

    This DataFrame will be passed to the `pivot_table` method to turn 
    it into a wide DataFrame. It will then be passed to the 
    `prepare_wide_data` function.

index : str
    Name of column used for the time period. It will be placed in the index

columns : str
    Name of column containing the categories for each time period. This column
    will get pivoted so that each unique value is a column.

values : str
    Name of column holding the values for each time period of each category.
    This column will become the values of the resulting DataFrame

aggfunc : str or aggregation function, default &amp;#39;sum&amp;#39;
    String name of aggregation function (&amp;#39;sum&amp;#39;, &amp;#39;min&amp;#39;, &amp;#39;mean&amp;#39;, &amp;#39;max, etc...) 
    or actual function (np.sum, np.min, etc...). 
    Categories that have multiple values for the same time period must be 
    aggregated for the animation to work.

orientation : &amp;#39;h&amp;#39; or &amp;#39;v&amp;#39;, default &amp;#39;h&amp;#39;
    Bar orientation - horizontal or vertical

sort : &amp;#39;desc&amp;#39; or &amp;#39;asc&amp;#39;, default &amp;#39;desc&amp;#39;
    Choose how to sort the bars. Use &amp;#39;desc&amp;#39; to put largest bars on 
    top and &amp;#39;asc&amp;#39; to place largest bars on bottom.

n_bars : int, default None
    Choose the maximum number of bars to display on the graph.
    By default, use all bars. New bars entering the race will 
    appear from the bottom or top.

interpolate_period : bool, default `False`
    Whether to interpolate the period. Only valid for datetime or
    numeric indexes. When set to `True`, for example, 
    the two consecutive periods 2020-03-29 and 2020-03-30 with 
    `steps_per_period` set to 4 would yield a new index of
    2020-03-29 00:00:00
    2020-03-29 06:00:00
    2020-03-29 12:00:00
    2020-03-29 18:00:00
    2020-03-30 00:00:00

steps_per_period : int, default 10
    The number of steps to go from one time period to the next. 
    The bars will grow linearly between each period.

compute_ranks : bool, default True
    When `True` return both the interpolated values and ranks DataFrames
    Otherwise just return the values

Returns
-------
A tuple of DataFrames. The first is the interpolated values and the second
is the interpolated ranks.

Examples
--------
df_values, df_ranks = bcr.prepare_long_data(df)
bcr.bar_chart_race(df_values, steps_per_period=1, period_length=50)
&amp;#39;&amp;#39;&amp;#39;
df_wide = df.pivot_table(index=index, columns=columns, values=values, aggfunc=aggfunc)
return prepare_wide_data(df_wide, orientation, sort, n_bars, interpolate_period,
                         steps_per_period, compute_ranks)&lt;/code&gt;&lt;/pre&gt;
</code></pre></div>


<p></details> </dd> <dt id=bar_chart_race.prepare_wide_data><code class="name flex"> <span>def <span class=ident>prepare_wide_data</span></span>(<span>df, orientation='h', sort='desc', n_bars=None, interpolate_period=False, steps_per_period=10, compute_ranks=True)</span> </code></dt> <dd> <div class=desc><p>Prepares 'wide' data for bar chart animation. Returns two DataFrames - the interpolated values and the interpolated ranks</p> <p>There is no need to use this function directly to create the animation. You can pass your DataFrame directly to <code><a title=bar_chart_race.bar_chart_race href=#bar_chart_race.bar_chart_race>bar_chart_race()</a></code>.</p> <p>This function is useful if you want to view the prepared data without creating an animation.</p> <h2 id=parameters>Parameters</h2> <dl> <dt><strong><code>df</code></strong> :&ensp;<code>pandas DataFrame</code></dt> <dd>Must be a 'wide' pandas DataFrame where each row represents a single period of time. Each column contains the values of the bars for that category. Optionally, use the index to label each time period.</dd> <dt><strong><code>orientation</code></strong> :&ensp;<code>'h'</code> or <code>'v'</code>, default <code>'h'</code></dt> <dd>Bar orientation - horizontal or vertical</dd> <dt><strong><code>sort</code></strong> :&ensp;<code>'desc'</code> or <code>'asc'</code>, default <code>'desc'</code></dt> <dd>Choose how to sort the bars. Use 'desc' to put largest bars on top and 'asc' to place largest bars on bottom.</dd> <dt><strong><code>n_bars</code></strong> :&ensp;<code>int</code>, default <code>None</code></dt> <dd>Choose the maximum number of bars to display on the graph. By default, use all bars. New bars entering the race will appear from the bottom or top.</dd> <dt><strong><code>interpolate_period</code></strong> :&ensp;<code>bool</code>, default <code>False</code></dt> <dd>Whether to interpolate the period. Only valid for datetime or numeric indexes. When set to <code>True</code>, for example, the two consecutive periods 2020-03-29 and 2020-03-30 with <code>steps_per_period</code> set to 4 would yield a new index of 2020-03-29 00:00:00 2020-03-29 06:00:00 2020-03-29 12:00:00 2020-03-29 18:00:00 2020-03-30 00:00:00</dd> <dt><strong><code>steps_per_period</code></strong> :&ensp;<code>int</code>, default <code>10</code></dt> <dd>The number of steps to go from one time period to the next. The bars will grow linearly between each period.</dd> <dt><strong><code>compute_ranks</code></strong> :&ensp;<code>bool</code>, default <code>True</code></dt> <dd>When <code>True</code> return both the interpolated values and ranks DataFrames Otherwise just return the values</dd> </dl> <h2 id=returns>Returns</h2> <dl> <dt><code>A tuple</code> of <code>DataFrames. The first is the interpolated values and the second</code></dt> <dd>&nbsp;</dd> </dl> <p>is the interpolated ranks.</p> <h2 id=examples>Examples</h2> <p>df_values, df_ranks = bcr.prepare_wide_data(df)</p></div> <details class=source> <summary> <span>Expand source code</span> </summary> <pre><code class=python>def prepare_wide_data(df, orientation=&#39;h&#39;, sort=&#39;desc&#39;, n_bars=None, interpolate_period=False, 
                      steps_per_period=10, compute_ranks=True):
    &#39;&#39;&#39;
    Prepares &#39;wide&#39; data for bar chart animation. 
    Returns two DataFrames - the interpolated values and the interpolated ranks</p>
<div class=codehilite><pre><span></span><code>There is no need to use this function directly to create the animation. 
You can pass your DataFrame directly to `bar_chart_race`.

This function is useful if you want to view the prepared data without 
creating an animation.

Parameters
----------
df : pandas DataFrame
    Must be a &amp;#39;wide&amp;#39; pandas DataFrame where each row represents a 
    single period of time. 
    Each column contains the values of the bars for that category. 
    Optionally, use the index to label each time period.

orientation : &amp;#39;h&amp;#39; or &amp;#39;v&amp;#39;, default &amp;#39;h&amp;#39;
    Bar orientation - horizontal or vertical

sort : &amp;#39;desc&amp;#39; or &amp;#39;asc&amp;#39;, default &amp;#39;desc&amp;#39;
    Choose how to sort the bars. Use &amp;#39;desc&amp;#39; to put largest bars on 
    top and &amp;#39;asc&amp;#39; to place largest bars on bottom.

n_bars : int, default None
    Choose the maximum number of bars to display on the graph.
    By default, use all bars. New bars entering the race will 
    appear from the bottom or top.

interpolate_period : bool, default `False`
    Whether to interpolate the period. Only valid for datetime or
    numeric indexes. When set to `True`, for example, 
    the two consecutive periods 2020-03-29 and 2020-03-30 with 
    `steps_per_period` set to 4 would yield a new index of
    2020-03-29 00:00:00
    2020-03-29 06:00:00
    2020-03-29 12:00:00
    2020-03-29 18:00:00
    2020-03-30 00:00:00

steps_per_period : int, default 10
    The number of steps to go from one time period to the next. 
    The bars will grow linearly between each period.

compute_ranks : bool, default True
    When `True` return both the interpolated values and ranks DataFrames
    Otherwise just return the values

Returns
-------
A tuple of DataFrames. The first is the interpolated values and the second
is the interpolated ranks.

Examples
--------
df_values, df_ranks = bcr.prepare_wide_data(df)
&amp;#39;&amp;#39;&amp;#39;
if n_bars is None:
    n_bars = df.shape[1]

df_values = df.reset_index()
df_values.index = df_values.index * steps_per_period
new_index = range(df_values.index[-1] + 1)
df_values = df_values.reindex(new_index)
if interpolate_period:
    if df_values.iloc[:, 0].dtype.kind == &amp;#39;M&amp;#39;:
        first, last = df_values.iloc[[0, -1], 0]
        dr = pd.date_range(first, last, periods=len(df_values))
        df_values.iloc[:, 0] = dr
    else:
        df_values.iloc[:, 0] = df_values.iloc[:, 0].interpolate()
else:
    df_values.iloc[:, 0] = df_values.iloc[:, 0].fillna(method=&amp;#39;ffill&amp;#39;)

df_values = df_values.set_index(df_values.columns[0])
if compute_ranks:
    df_ranks = df_values.rank(axis=1, method=&amp;#39;first&amp;#39;, ascending=False).clip(upper=n_bars + 1)
    if (sort == &amp;#39;desc&amp;#39; and orientation == &amp;#39;h&amp;#39;) or (sort == &amp;#39;asc&amp;#39; and orientation == &amp;#39;v&amp;#39;):
        df_ranks = n_bars + 1 - df_ranks
    df_ranks = df_ranks.interpolate()

df_values = df_values.interpolate()
if compute_ranks:
    return df_values, df_ranks
return df_values&lt;/code&gt;&lt;/pre&gt;
</code></pre></div>


<p></details> </dd> </dl> </section> <section> </section> </article> <nav id=sidebar> <h1>Index</h1> <div class=toc> <ul></ul> </div> <ul id=index> <li><h3><a href=#header-functions>Functions</a></h3> <ul class> <li><code><a title=bar_chart_race.bar_chart_race href=#bar_chart_race.bar_chart_race>bar_chart_race</a></code></li> <li><code><a title=bar_chart_race.load_dataset href=#bar_chart_race.load_dataset>load_dataset</a></code></li> <li><code><a title=bar_chart_race.prepare_long_data href=#bar_chart_race.prepare_long_data>prepare_long_data</a></code></li> <li><code><a title=bar_chart_race.prepare_wide_data href=#bar_chart_race.prepare_wide_data>prepare_wide_data</a></code></li> </ul> </li> </ul> </nav> </main> <footer id=footer> <p>Generated by <a href=https://pdoc3.github.io/pdoc><cite>pdoc</cite> 0.8.1</a>.</p> </footer> <script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js></script> <script>hljs.initHighlightingOnLoad()</script> </body> </html></p> </article> </div> </div> </main> <footer class=md-footer> <div class=md-footer-nav> <nav class="md-footer-nav__inner md-grid" aria-label=Footer> <a href=../upcoming/ title="Upcoming Features" class="md-footer-nav__link md-footer-nav__link--prev" rel=prev> <div class="md-footer-nav__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </div> <div class=md-footer-nav__title> <div class=md-ellipsis> <span class=md-footer-nav__direction> Previous </span> Upcoming Features </div> </div> </a> </nav> </div> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-footer-copyright> <div class=md-footer-copyright__highlight> Copyright @ 2020 Ted Petrou </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> <div class=md-footer-social> <a href=https://github.com/dexplo target=_blank rel=noopener title=github.com class=md-footer-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 480 512"><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"/></svg> </a> <a href=https://twitter.com/TedPetrou target=_blank rel=noopener title=twitter.com class=md-footer-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg> </a> <a href=https://linkedin.com/in/TedPetrou target=_blank rel=noopener title=linkedin.com class=md-footer-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg> </a> <a href=https://www.youtube.com/c/dunderdata target=_blank rel=noopener title=www.youtube.com class=md-footer-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 576 512"><path d="M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78 0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305zm-317.51 213.508V175.185l142.739 81.205-142.739 81.201z"/></svg> </a> <a href=https://www.facebook.com/dunderdata target=_blank rel=noopener title=www.facebook.com class=md-footer-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><path d="M504 256C504 119 393 8 256 8S8 119 8 256c0 123.78 90.69 226.38 209.25 245V327.69h-63V256h63v-54.64c0-62.15 37-96.48 93.67-96.48 27.14 0 55.52 4.84 55.52 4.84v61h-31.28c-30.8 0-40.41 19.12-40.41 38.73V256h68.78l-11 71.69h-57.78V501C413.31 482.38 504 379.78 504 256z"/></svg> </a> </div> </div> </div> </footer> </div> <script src=../assets/javascripts/vendor.d710d30a.min.js></script> <script src=../assets/javascripts/bundle.5f27aba8.min.js></script><script id=__lang type=application/json>{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents"}</script> <script>
        app = initialize({
          base: "..",
          features: ["tabs"],
          search: Object.assign({
            worker: "../assets/javascripts/worker/search.27c6a5e6.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script> <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML"></script> </body> </html>